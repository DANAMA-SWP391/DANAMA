<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Controller Test</title>
    <script>
        // Function to send POST request to ReviewController
        async function sendReviewRequest(action, reviewData) {
            try {
                const response = await fetch('http://localhost:8080/DANAMA_war_exploded/review', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: action,
                        review: reviewData
                    })
                });

                const contentType = response.headers.get('content-type');
                if (contentType && contentType.includes('application/json')) {
                    const result = await response.json();
                    console.log(result);
                    document.getElementById("result").innerText = JSON.stringify(result, null, 2);
                } else {
                    console.error('Server returned a non-JSON response.');
                    document.getElementById("result").innerText = 'Error: Non-JSON response received';
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Function to get the current date and time in YYYY-MM-DD HH:MM:SS format
        function getCurrentDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are 0-based, so add 1
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;  // Returns the date and time as "YYYY-MM-DD HH:MM:SS"
        }

        function addReview() {
            const review = {
                reviewId: 1,  // Assuming new reviews may not need an ID
                rating: document.getElementById("rating").value,
                comment: document.getElementById("comment").value,
                date: getCurrentDateTime(),  // Automatically set the current date and time
                uid: 1,  // Example UID, adjust as needed
                movieId: 1  // Example movie ID, adjust as needed
            };
            sendReviewRequest("ADD", review);
        }

        function updateReview() {
            const review = {
                reviewId: document.getElementById("reviewId").value,
                rating: document.getElementById("rating").value,
                comment: document.getElementById("comment").value,
                date: getCurrentDateTime(),  // Automatically set the current date and time for update as well
                uid: 1,
                movieId: 1
            };
            sendReviewRequest("UPDATE", review);
        }

        function deleteReview() {
            const review = {
                reviewId: document.getElementById("reviewId").value
            };
            sendReviewRequest("DELETE", review);
        }
    </script>
</head>
<body>

<h1>Test Review Controller</h1>

<h3>Add or Update Review</h3>
<label for="reviewId">Review ID (only for update or delete):</label>
<input type="text" id="reviewId" placeholder="Review ID">
<br>
<label for="rating">Rating:</label>
<input type="number" id="rating" placeholder="Rating" min="1" max="5">
<br>
<label for="comment">Comment:</label>
<input type="text" id="comment" placeholder="Comment">
<br><br>

<button onclick="addReview()">Add Review</button>
<button onclick="updateReview()">Update Review</button>

<h3>Delete Review</h3>
<button onclick="deleteReview()">Delete Review</button>

<h3>Result:</h3>
<pre id="result"></pre>

</body>
</html>
